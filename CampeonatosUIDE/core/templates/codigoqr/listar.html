{% extends 'comun/base.html' %}
<!-- Hereda la plantilla base del proyecto (estructura, cabecera, pie, etc.) -->

{% load static %}
<!-- Carga archivos est√°ticos si se necesitan (CSS, im√°genes, JS, etc.) -->

{% block title %}C√≥digos QR - Campeonatos UIDE{% endblock %}
<!-- T√≠tulo que se muestra en la pesta√±a del navegador -->

{% block content %}
<!-- Inicio del bloque principal de contenido -->

<section class="section">
  <!-- Secci√≥n visual principal con m√°rgenes verticales -->
  <div class="container">
    <!-- Contenedor centrado para el contenido -->

    <div class="box" style="border-radius: 18px; background-color: #fffef8; padding: 2.2rem; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">
      <!-- Caja visual clara con bordes redondeados, padding y sombra suave -->

      <div class="is-flex is-justify-content-space-between is-align-items-center mb-4">
        <!-- Fila con t√≠tulo y bot√≥n alineados en extremos -->
        <h2 class="title is-3 has-text-danger">üßæ C√≥digos QR Registrados</h2>
        <!-- T√≠tulo rojo con √≠cono y tama√±o grande -->
        <a href="{% url 'registrar_codigo_qr' %}" class="button is-warning is-rounded">
          <!-- Bot√≥n amarillo redondeado para registrar nuevo c√≥digo QR -->
          <strong>+ Agregar QR</strong>
        </a>
      </div>

      <form method="get" class="mb-4">
        <!-- Formulario para buscar c√≥digos QR -->
        <div class="field has-addons">
          <!-- Grupo de campos juntos (input + bot√≥n) -->
          <div class="control is-expanded">
            <!-- Campo de texto expandido (ocupa todo el ancho disponible) -->
            <input class="input" type="text" name="q" value="{{ request.GET.q }}" placeholder="üîç Buscar por banco o n√∫mero de cuenta">
            <!-- Input para b√∫squeda, mantiene el valor actual si se ha buscado -->
          </div>
          <div class="control">
            <!-- Bot√≥n para ejecutar la b√∫squeda -->
            <button type="submit" class="button is-info">Buscar</button>
          </div>
        </div>
      </form>

      {% if codigos_qr %}
        <!-- Si hay c√≥digos QR registrados, muestra la tabla -->
        <table class="table is-fullwidth is-hoverable is-striped">
          <!-- Tabla completa, con filas resaltadas al pasar el mouse y filas alternadas -->
          <thead>
            <!-- Cabecera de la tabla -->
            <tr class="has-background-warning-light">
              <!-- Fila de cabecera con fondo amarillo claro -->
              <th>Banco</th>
              <th>N√∫mero de Cuenta</th>
              <th>Imagen</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for codigo in codigos_qr %}
              <!-- Itera sobre cada c√≥digo QR -->
              <tr>
                <td>{{ codigo.banco }}</td>
                <!-- Muestra el banco asociado al c√≥digo -->
                <td>{{ codigo.numero_cuenta }}</td>
                <!-- Muestra el n√∫mero de cuenta -->
                <td>
                  {% if codigo.imagen_qr %}
                    <!-- Si tiene imagen QR asociada -->
                    <img src="{{ codigo.imagen_qr.url }}" width="80" alt="QR Banco">
                    <!-- Muestra la imagen con ancho limitado -->
                  {% else %}
                    <em>Sin imagen</em>
                    <!-- Muestra mensaje si no tiene imagen QR -->
                  {% endif %}
                </td>
                <td>
                  <!-- Acciones disponibles: editar y eliminar -->
                  <a href="{% url 'editar_codigo_qr' codigo.id %}" class="button is-small is-info is-light">‚úèÔ∏è Editar</a>
                  <a href="{% url 'eliminar_codigo_qr' codigo.id %}" class="button is-small is-danger is-light"
                     onclick="return confirm('¬øEst√°s seguro de eliminar este c√≥digo QR?');">
                    üóëÔ∏è Eliminar
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <!-- Si no hay c√≥digos QR registrados -->
        <div class="notification is-warning is-light has-text-centered">
          No hay c√≥digos QR registrados todav√≠a.
        </div>
      {% endif %}
    </div>

  </div>
</section>
{% endblock %}
<!-- Fin del bloque de contenido principal -->
