{% extends 'comun/base.html' %}

{% block title %}Tabla Pública - {{ campeonato.nombre }}{% endblock %}

{% block content %}
<!-- Sección principal que contiene la tabla de posiciones de un campeonato -->
<section class="section">
  <!-- Contenedor central para el contenido -->
  <div class="container">

    <!-- Título principal con el nombre del campeonato -->
    <h1 class="title is-3">Tabla de Posiciones - {{ campeonato.nombre }}</h1>

    <!-- Subtítulo descriptivo -->
    <p class="subtitle is-6">Consulta cómo van los equipos en el campeonato</p>

    <!-- Contenedor para la tabla, con scroll horizontal si es necesario -->
    <div class="table-container">
      <!-- Tabla con estilos para rayas y efectos hover, ocupa todo el ancho -->
      <table class="table is-striped is-hoverable is-fullwidth">
        <thead>
          <tr>
            <!-- Encabezados de columnas -->
            <th>#</th>
            <th>Equipo</th>
            <th>Puntos</th>
            <th>Logo</th>
          </tr>
        </thead>
        <tbody>
          <!-- Bucle que recorre todos los equipos para mostrar su info -->
          {% for equipo in equipos %}
          <tr>
            <!-- Número de fila usando el contador del forloop -->
            <td>{{ forloop.counter }}</td>
            <!-- Nombre del equipo -->
            <td>{{ equipo.nombre }}</td>
            <!-- Puntos totales del equipo -->
            <td>{{ equipo.puntos_totales }}</td>
            <td>
              <!-- Condicional para mostrar logo si existe -->
              {% if equipo.logo %}
                <figure class="image is-64x64">
                  <img src="{{ equipo.logo.url }}" alt="Logo equipo">
                </figure>
              {% else %}
                <!-- Mensaje si el equipo no tiene logo -->
                <span class="has-text-grey-light">Sin logo</span>
              {% endif %}
            </td>
          </tr>
          <!-- Caso si no hay equipos registrados -->
          {% empty %}
          <tr>
            <td colspan="4" class="has-text-centered">Aún no hay equipos registrados.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Mensajes personalizados según el rol del usuario autenticado -->
    {% if user.is_authenticated %}
      {% if user.rol == "DELEGADO" %}
        <p class="has-text-success mt-4">Eres delegado. Puedes registrar tu equipo si aún no lo has hecho.</p>
      {% elif user.rol == "JUGADOR" %}
        <p class="has-text-info mt-4">Eres jugador. Puedes seguir el progreso de tu equipo desde esta tabla.</p>
      {% elif user.rol == "ADMIN" %}
        <p class="has-text-danger mt-4">Eres administrador. Puedes gestionar este campeonato desde el panel.</p>
      {% endif %}
    {% endif %}

    <!-- Botón para volver a la lista pública de campeonatos -->
    <a href="{% url 'campeonatos_publicos' %}" class="button is-light mt-5">⬅ Volver a campeonatos</a>

  </div>
</section>

{% endblock %}
